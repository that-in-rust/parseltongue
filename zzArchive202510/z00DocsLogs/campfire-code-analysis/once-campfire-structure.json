{
  "summary": {
    "total_ruby_files": 117,
    "models": 38,
    "controllers": 41,
    "channels": 8,
    "database_tables": 15
  },
  "core_models": {
    "user": {
      "file": "app/models/user.rb",
      "concerns": ["user/bot.rb", "user/avatar.rb", "user/role.rb", "user/transferable.rb", "user/mentionable.rb"],
      "relationships": ["has_many memberships", "has_many rooms through memberships", "has_many messages", "has_one webhook"]
    },
    "room": {
      "file": "app/models/room.rb",
      "concerns": ["room/message_pusher.rb"],
      "types": ["rooms/open.rb", "rooms/closed.rb", "rooms/direct.rb"],
      "relationships": ["has_many memberships", "has_many users through memberships", "has_many messages", "belongs_to creator (User)"]
    },
    "message": {
      "file": "app/models/message.rb",
      "concerns": ["message/broadcasts.rb", "message/pagination.rb", "message/attachment.rb", "message/mentionee.rb", "message/searchable.rb"],
      "relationships": ["belongs_to room", "belongs_to creator (User)", "has_many boosts", "has_many mentionees"]
    },
    "membership": {
      "file": "app/models/membership.rb",
      "concerns": ["membership/connectable.rb"],
      "relationships": ["belongs_to user", "belongs_to room"],
      "tracks": ["unread_at", "involvement (mentions|all|nothing)", "connections (WebSocket count)", "connected_at"]
    }
  },
  "database_schema": {
    "users": ["id", "name", "role (enum: 0=member)", "email_address", "password_digest", "active (boolean)", "bio", "bot_token"],
    "rooms": ["id", "name", "type (STI: Room::Open, Room::Closed, Room::Direct)", "creator_id"],
    "messages": ["id", "room_id", "creator_id", "client_message_id"],
    "memberships": ["id", "room_id", "user_id", "unread_at", "involvement", "connections", "connected_at"],
    "boosts": ["id", "message_id", "booster_id", "content (16 char emoji)"],
    "push_subscriptions": ["id", "user_id", "endpoint", "p256dh_key", "auth_key", "user_agent"],
    "sessions": ["id", "user_id", "token", "ip_address", "user_agent", "last_active_at"],
    "webhooks": ["id", "user_id", "url"],
    "accounts": ["id", "name", "join_code", "custom_styles"],
    "searches": ["id", "user_id", "query"],
    "message_search_index": ["FTS5 full-text search index"]
  },
  "key_features": {
    "real_time": {
      "channels": [
        "heartbeat_channel.rb",
        "presence_channel.rb",
        "read_rooms_channel.rb",
        "room_channel.rb",
        "typing_notifications_channel.rb",
        "unread_rooms_channel.rb"
      ],
      "technology": "ActionCable (WebSocket over Rails)"
    },
    "authentication": {
      "concerns": ["authentication.rb", "authentication/session_lookup.rb"],
      "strategy": "Session-based with tokens",
      "supports_bot_tokens": true
    },
    "search": {
      "implementation": "SQLite FTS5 (Full-Text Search)",
      "model": "app/models/search.rb",
      "concern": "message/searchable.rb"
    },
    "notifications": {
      "web_push": "push_subscriptions table with VAPID keys",
      "mentions": "@mention support via message/mentionee.rb"
    },
    "rich_content": {
      "action_text": "Rich text for message bodies",
      "active_storage": "File attachments with previews",
      "opengraph": "Link unfurling (opengraph/fetch.rb, opengraph/metadata.rb)"
    }
  }
}
